### Issue Description

The current method for generating `ArticleTag`s in the `hermes` project is a mix of effective and ineffective strategies.

The **effective strategy** involves splitting the product `ArticleDescription.description` using the `ArticleBrand.brand` as a delimiter. This successfully isolates the generic product name (e.g., "Galletitas de Chocolate") from the full description (e.g., "Galletitas de Chocolate Bagley"), creating high-quality, relevant tags. These tags should be preserved.

However, the secondary strategy, which uses `thefuzz` library for fuzzy string matching, is the source of the problem. This method generates a flat and noisy tag space, leading to several issues:

1.  **Lack of Standardization:** It creates multiple tags for the same concept (e.g., `"chocolate"`, `"sabor chocolate"`, `"choc"`).
2.  **Redundancy and Noise:** It produces useless tags from stop words (`"de"`, `"con"`) and fails to handle plurals (`"galletita"` vs. `"galletitas"`).
3.  **No Semantic Hierarchy:** It cannot understand relationships between tags (e.g., `"chocolate"` and `"chocolate blanco"` are treated as unrelated).

The goal is to replace the noisy, flat tags generated by `thefuzz` with a curated, hierarchical system, while migrating the high-quality tags from the brand-splitting method.

-----

### Updated Prompt for Your Next Chat

Here is the refined prompt that incorporates your feedback.

-----

Hello\! I have a Python project called `hermes` that scrapes and processes product data. I need to overhaul the product tagging system to make it more intelligent and structured, while preserving the parts that already work well.

Currently, I have many `ArticleTag`s. The high-quality tags—generated by splitting the product description by the brand name—should be kept. However, thousands of noisy and inconsistent tags generated with the `thefuzz` library need to be replaced.

Here are the requirements:

**1. New Database Model (`hermes/domain/models.py`)**

  * Create a new SQLAlchemy model called `TagDictionary`.
  * It should have the following columns:
      * `id`: Standard primary key.
      * `tag_name`: A unique string for the official tag name (e.g., "CHOCOLATE", "GALLETITAS").
      * `parent_id`: A foreign key pointing to `tag_dictionary.id` to create a self-referencing hierarchy (e.g., "BLANCO" could have "CHOCOLATE" as a parent). This column should be nullable.
  * Establish the one-to-many relationship for the hierarchy within the `TagDictionary` model itself.

**2. New Association Table (`hermes/domain/models.py`)**

  * Create a new many-to-many association table to link `ArticleCard` records to the new `TagDictionary`.
  * Update the `ArticleCard` model to include a relationship to `TagDictionary` through this new table.

**3. Initial Tag Dictionary (`scripts/populate_tag_dictionary.py`)**

  * Create a new script that defines an initial, curated list of hierarchical tags.
  * This script should connect to the database and populate the `tag_dictionary` table with this predefined data.
  * Example initial data structure in the script:
    ```python
    TAG_HIERARCHY = {
        "ALMACEN": {},
        "BEBIDAS": {
            "CON ALCOHOL": {},
            "SIN ALCOHOL": {
                "GASEOSA": {},
                "AGUA": {}
            }
        },
        "FRESCOS": {
            "LACTEOS": {
                "LECHE": {},
                "QUESO": {},
                "YOGUR": {}
            }
        }
    }
    ```

**4. Intelligent Tagging and Migration Script (`scripts/hermes_intelligent_tagging.py`)**

  * Create a new script to perform the intelligent tagging and cleanup.
  * **Functionality:**
    1.  **Load Official Tags:** The script should load all tags from the `TagDictionary` into memory.
    2.  **Migrate Good Tags:** It should identify the high-quality `ArticleTag`s (those derived from splitting the description by brand). For each of these, it should find or create a matching entry in the `TagDictionary` and link the corresponding `ArticleCard`s to it via the new association table.
    3.  **Intelligent Tagging for Untagged Products:** It will then iterate through `ArticleCard`s that still lack tags from the new system.
    4.  For each `ArticleCard`, it will use its `description` to prompt an LLM (Gemini), providing the list of official tags from the `TagDictionary`.
    5.  The prompt will ask the LLM to select the most relevant tags from the provided list to describe the product.
    6.  The script will parse the LLM's response and create the links in the new many-to-many association table.
    7.  **Cleanup (Optional but Recommended):** After verifying the new system works, this script (or a separate one) could be used to remove the old, noisy tags and the original `article_cards_and_article_tags` association table.
  * The script should process articles in batches to manage API calls and database transactions efficiently.
